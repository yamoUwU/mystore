(()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,a,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function u(e,r,o,i){var u=r&&r.prototype instanceof l?r:l,s=Object.create(u.prototype);return n(s,"_invoke",function(e,n,r){var o,i,u,l=0,s=r||[],d=!1,p={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return o=e,i=0,u=t,p.n=n,c}};function f(e,n){for(i=e,u=n,a=0;!d&&l&&!r&&a<s.length;a++){var r,o=s[a],f=p.p,g=o[2];e>3?(r=g===n)&&(u=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=f&&((r=e<2&&f<o[1])?(i=0,p.v=n,p.n=o[1]):f<g&&(r=e<3||o[0]>n||n>g)&&(o[4]=e,o[5]=n,p.n=g,i=0))}if(r||e>1)return c;throw d=!0,n}return function(r,s,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===s&&f(s,g),i=s,u=g;(a=i<2?t:u)||!d;){o||(i?i<3?(i>1&&(p.n=-1),f(i,u)):p.n=u:p.v=u);try{if(l=2,o){if(i||(r="next"),a=o[r]){if(!(a=a.call(o,u)))throw TypeError("iterator result is not an object");if(!a.done)return a;u=a.value,i<2&&(i=0)}else 1===i&&(a=o.return)&&a.call(o),i<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=t}else if((a=(d=p.n<0)?u:e.call(n,p))!==c)break}catch(e){o=t,i=1,u=e}finally{l=1}}return{value:a,done:d}}}(e,o,i),!0),s}var c={};function l(){}function s(){}function d(){}a=Object.getPrototypeOf;var p=[][o]?a(a([][o]())):(n(a={},o,(function(){return this})),a),f=d.prototype=l.prototype=Object.create(p);function g(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,n(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=d,n(f,"constructor",d),n(d,"constructor",s),s.displayName="GeneratorFunction",n(d,i,"GeneratorFunction"),n(f),n(f,i,"Generator"),n(f,o,(function(){return this})),n(f,"toString",(function(){return"[object Generator]"})),(e=function(){return{w:u,m:g}})()}function n(t,e,a,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}n=function(t,e,a,r){if(e)o?o(t,e,{value:a,enumerable:!r,configurable:!r,writable:!r}):t[e]=a;else{var i=function(e,a){n(t,e,(function(t){return this._invoke(e,a,t)}))};i("next",0),i("throw",1),i("return",2)}},n(t,e,a,r)}function a(t,e,n,a,r,o,i){try{var u=t[o](i),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(a,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){a(i,r,o,u,c,"next",t)}function c(t){a(i,r,o,u,c,"throw",t)}u(void 0)}))}}function o(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,i(a.key),a)}}function i(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var u=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},n=[{key:"init",value:function(){var t=this;$(document).on("click",".btn-trigger-remove-plugin",(function(t){t.preventDefault(),$("#confirm-remove-plugin-button").data("url",$(t.currentTarget).data("url")),$("#remove-plugin-modal").modal("show")})),$(document).on("click","#confirm-remove-plugin-button",(function(t){t.preventDefault();var e=$(t.currentTarget);$httpClient.make().withButtonLoading(e).delete(e.data("url")).then((function(t){var e=t.data;Botble.showSuccess(e.message),window.location.reload()})).finally((function(){return $("#remove-plugin-modal").modal("hide")}))})),$(document).on("click",".btn-trigger-update-plugin",(function(t){t.preventDefault();var e=$(t.currentTarget),n=e.data("update-url");e.prop("disabled",!0),$httpClient.make().withButtonLoading(e).post(n).then((function(t){var e=t.data;Botble.showSuccess(e.message),localStorage.removeItem("plugin_update_check_time"),localStorage.removeItem("plugin_update_data"),setTimeout((function(){return window.location.reload()}),2e3)})).finally((function(){return e.prop("disabled",!1)}))})),$(document).on("click",".btn-trigger-change-status",function(){var n=r(e().m((function n(a){var r,o,i;return e().w((function(e){for(;;)switch(e.n){case 0:if(a.preventDefault(),r=$(a.currentTarget),o=r.data("plugin"),i=r.data("change-status-url"),1!==r.data("status")){e.n=2;break}return Botble.showButtonLoading(r),e.n=1,t.activateOrDeactivatePlugin(i);case 1:return Botble.hideButtonLoading(r),e.a(2);case 2:$httpClient.makeWithoutErrorHandler().withButtonLoading(r).post(r.data("check-requirement-url")).then((function(){return t.activateOrDeactivatePlugin(i)})).catch((function(t){var e=t.response.data,n=e.data,a=e.message;if(n&&n.existing_plugins_on_marketplace){var r=$("#confirm-install-plugin-modal");return r.find(".modal-body #requirement-message").html(a),r.find('input[name="plugin_name"]').val(o),r.find('input[name="ids"]').val(n.existing_plugins_on_marketplace),void r.modal("show")}Botble.showError(a)}));case 3:return e.a(2)}}),n)})));return function(t){return n.apply(this,arguments)}}()),$("button[data-check-update]").length&&this.checkUpdate(),this.handleFilters()}},{key:"handleFilters",value:function(){var t=$('[data-bb-toggle="change-search"]').val().toLowerCase(),e=$('[data-bb-toggle="change-filter-plugin-status"]:checked').val();$('button[data-bb-toggle="change-filter-plugin-status"]').each((function(t,e){var n=$(e).data("value")||$(e).val(),a="all"===n?$(".plugin-item:visible"):$('.plugin-item[data-status="'.concat(n,'"]:visible'));$('[data-bb-toggle="plugins-count"][data-status="'.concat(n,'"]')).text(a.length)}));var n=function(){$(".plugin-item").each((function(n,a){var r=$(a),o=r.data("name").toLowerCase(),i=r.data("description").toLowerCase(),u=r.data("author").toLowerCase(),c=o.includes(t),l=u.includes(t),s=i.includes(t),d="all"===e||r.data("status")===e||"updates-available"===e&&r.data("available-for-updates");(c||s||l)&&d?r.show():r.hide()})),0===$(".plugin-item:visible").length?$(".empty").show():$(".empty").hide()};$(document).on("keyup",'[data-bb-toggle="change-search"]',(function(e){e.preventDefault(),t=$(e.currentTarget).val().toLowerCase(),n()})),$(document).on("change",'input[data-bb-toggle="change-filter-plugin-status"]',(function(t){e=$(t.currentTarget).val(),n()})),$(document).on("click",'button[data-bb-toggle="change-filter-plugin-status"]',(function(t){var a=$(t.target).data("value");$('[data-bb-toggle="status-filter-label"]').text($(t.target).text()),$(".dropdown-item").removeClass("active"),$(t.target).addClass("active"),e=a,n()}))}},{key:"checkUpdate",value:function(){var t=this,e=function(){var t=localStorage.getItem("plugin_update_check_time");return!t||Date.now()-parseInt(t)>9e5},n=localStorage.getItem("plugin_update_data");if(n&&!e())try{var a=JSON.parse(n);return void this.processUpdateData(a)}catch(t){}e()&&$httpClient.make().post($("button[data-check-update]").data("check-update-url")).then((function(e){var n=e.data;localStorage.setItem("plugin_update_check_time",Date.now().toString()),n.data?(localStorage.setItem("plugin_update_data",JSON.stringify(n.data)),t.processUpdateData(n.data)):localStorage.removeItem("plugin_update_data")})).catch((function(){localStorage.setItem("plugin_update_check_time",Date.now().toString())}))}},{key:"processUpdateData",value:function(t){t&&Object.keys(t).forEach((function(e){var n=t[e],a=$('button[data-check-update="'.concat(n.name,'"]')),r=a.data("update-url").replace("__id__",n.id);a.data("update-url",r).show(),a.closest(".plugin-item").data("available-for-updates",!0).trigger("change"),$('[data-bb-toggle="plugins-count"][data-status="updates-available"]').text(Object.keys(t).length)}))}},{key:"activateOrDeactivatePlugin",value:(i=r(e().m((function t(n){var a,r=arguments;return e().w((function(t){for(;;)if(0===t.n)return a=!(r.length>1&&void 0!==r[1])||r[1],t.a(2,$httpClient.make().put(n).then((function(t){var e=t.data;Botble.showSuccess(e.message),a&&window.location.reload()})))}),t)}))),function(t){return i.apply(this,arguments)})}],n&&o(t.prototype,n),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,a,i}();$((function(){(new u).init()}))})();